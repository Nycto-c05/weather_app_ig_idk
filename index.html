<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="script.js" type="text/javascript"></script>    
    <title>Document</title>
</head>
<style>
    header{
        padding: 10px;
        border-radius: 15px 15px 15px 15px;
    }

    form{
        text-align: center;
        padding: 10px;
    }

    input{
        border-radius: 15px 15px 15px 15px;
        border-width: 1px;
    }

    #res{
        border-width: 2px;
    }
</style>
<script>
    function handleFormSubmit(event) {
    const apiKey = '83ddd664823c43e098470241233012';
    let city = undefined;
    // Prevent the default form submission
    event.preventDefault();

    const inputValue = document.getElementById('input').value;

    console.log('Input Value:', inputValue);

    city = inputValue;
    let res = undefined
    if (city) {
        const apiUrl = `http://api.weatherapi.com/v1/current.json?key=${apiKey}&q=${city}&aqi=yes`;
        currentWeather(apiUrl)
            .then(data => {
                res = data
                console.log(data);
                console.log(data.current.air_quality);
                HTMLres(res);
            })
            .catch(err => console.log('Error :', err.message))
        document.getElementById('input').value = ''

        
    }
    else {

    }
}

const HTMLres = (res) => {
    let location = document.getElementById('Location').textContent;
    document.getElementById('Location').textContent = res.location.name+' City, '+res.location.region+', '+res.location.country;
    console.log(location)

    const imgElement = document.getElementById('fav');

        // Set the new source URL
        const newSrc = res.current.condition.icon;
        console.log(newSrc)
        // Change the src attribute
        imgElement.src = newSrc;

    let temp = document.getElementById('temp').textContent;
        document.getElementById('temp').textContent = res.current.temp_c + '°C | '+ res.current.temp_f + '°F'
        console.log(temp)

    const ulElement = document.getElementById('list');

        ulElement.style.listStyleType = 'circle';

    let humid = document.getElementById('humid').textContent;
        document.getElementById('humid').textContent = 'Humidity: '+res.current.humidity+'%'
        console.log(humid)

    let wind = document.getElementById('wind').textContent;
    document.getElementById('wind').textContent = 'Wind: '+res.current.wind_kph+' kph'

}

const currentWeather = async (apiUrl) => {
    const res = await fetch(apiUrl);

    if (res.status !== 200) {
        throw new Error('Can\'t fetch from URL');
    }

    const data = await res.json()
    // console.log(data)

    return data
}
</script>
<header style="background-color: rgb(90, 21, 180);">
    <h1 style="text-align: center; color: white;">Weather Dashboard</h1>
</header>

<body>
    
    <form>
        <label for="input">Enter Name Of City:</label>
        <input type="text" id='input' name='input' placeholder="Enter Name Of City">
        <button style="border-radius: 15px; border-width: 1px;" type="submit" onclick="handleFormSubmit(event)">Submit</button>
    </form>

    <div id=res>
        <h2 id="Location"></h2>
    </div>
    <span>
        <img style="display: inline; vertical-align: middle;;" id='fav' src="" alt="">
        <h3 style="display: inline; vertical-align: middle;" id="temp"></h3>
    </span>

    <div>
        <ul id = 'list' style="list-style-type: none;">
            <li id="humid"></li>
            <li id="wind"></li>
        </ul>
    </div>
</body>

</html>
